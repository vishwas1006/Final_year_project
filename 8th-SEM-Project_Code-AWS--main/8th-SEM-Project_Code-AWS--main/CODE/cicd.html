<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>CI/CD Pipeline Dashboard</title>
    <style>
        :root {
            --primary: #3498db;
            --success: #2ecc71;
            --warning: #f39c12;
            --danger: #e74c3c;
            --dark: #34495e;
            --light: #ecf0f1;
            --gray: #95a5a6;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f7fa;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }
        
        header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 30px;
        }
        
        .page-title {
            font-size: 24px;
            color: var(--dark);
        }
        
        .card {
            background-color: white;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            margin-bottom: 20px;
            overflow: hidden;
        }
        
        .card-header {
            padding: 15px 20px;
            background-color: white;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .card-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .card-body {
            padding: 20px;
        }
        
        .quick-stats {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }
        
        .stat-card {
            padding: 20px;
            border-radius: 8px;
            background-color: white;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.05);
            display: flex;
            flex-direction: column;
            transition: background-color 0.3s ease;
        }
        
        .stat-card.updating {
            background-color: rgba(52, 152, 219, 0.1);
        }
        
        .stat-value {
            font-size: 28px;
            font-weight: 700;
            margin-bottom: 5px;
            transition: transform 0.2s ease;
        }
        
        .updating .stat-value {
            transform: scale(1.05);
        }
        
        .stat-title {
            font-size: 14px;
            color: var(--gray);
            margin-bottom: 10px;
        }
        
        .stat-trend {
            font-size: 14px;
            display: flex;
            align-items: center;
        }
        
        .stat-trend.up {
            color: var(--success);
        }
        
        .stat-trend.down {
            color: var(--danger);
        }
        
        .pipeline-list {
            list-style: none;
        }
        
        .pipeline-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 15px 0;
            border-bottom: 1px solid #eee;
        }
        
        .pipeline-item:last-child {
            border-bottom: none;
        }
        
        .pipeline-info {
            display: flex;
            align-items: center;
        }
        
        .pipeline-name {
            font-weight: 600;
            margin-right: 10px;
        }
        
        .pipeline-repo {
            color: var(--gray);
            font-size: 14px;
        }
        
        .pipeline-status {
            display: flex;
            align-items: center;
        }
        
        .status-badge {
            padding: 5px 10px;
            border-radius: 20px;
            font-size: 12px;
            font-weight: 600;
            margin-right: 15px;
        }
        
        .status-success {
            background-color: rgba(46, 204, 113, 0.15);
            color: var(--success);
        }
        
        .status-running {
            background-color: rgba(52, 152, 219, 0.15);
            color: var(--primary);
        }
        
        .status-failed {
            background-color: rgba(231, 76, 60, 0.15);
            color: var(--danger);
        }
        
        .status-pending {
            background-color: rgba(243, 156, 18, 0.15);
            color: var(--warning);
        }
        
        .btn {
            padding: 8px 16px;
            border-radius: 4px;
            font-size: 14px;
            font-weight: 600;
            cursor: pointer;
            border: none;
            transition: all 0.2s;
        }
        
        .btn-primary {
            background-color: var(--primary);
            color: white;
        }
        
        .btn-primary:hover {
            background-color: #2980b9;
        }
        
        .btn-outline {
            background-color: transparent;
            border: 1px solid var(--gray);
            color: var(--gray);
        }
        
        .btn-outline:hover {
            background-color: #f5f5f5;
        }
        
        .btn-success {
            background-color: var(--success);
            color: white;
        }
        
        .btn-success:hover {
            background-color: #27ae60;
        }
        
        .btn-sm {
            padding: 5px 10px;
            font-size: 12px;
        }
        
        .btn-icon {
            margin-right: 5px;
        }
        
        .action-btns {
            display: flex;
            gap: 10px;
        }
        
        .tabs {
            display: flex;
            margin-bottom: 20px;
            border-bottom: 1px solid #eee;
        }
        
        .tab {
            padding: 12px 20px;
            cursor: pointer;
            font-weight: 600;
            color: var(--gray);
            border-bottom: 3px solid transparent;
        }
        
        .tab.active {
            color: var(--primary);
            border-bottom: 3px solid var(--primary);
        }
        
        .build-history {
            margin-top: 20px;
        }
        
        .history-item {
            padding: 15px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .history-item:last-child {
            border-bottom: none;
        }
        
        .history-details {
            display: flex;
            flex-direction: column;
        }
        
        .build-number {
            font-weight: 600;
            margin-bottom: 5px;
        }
        
        .build-info {
            display: flex;
            align-items: center;
            font-size: 14px;
            color: var(--gray);
        }
        
        .build-info span {
            margin-right: 15px;
        }
        
        .build-duration {
            background-color: #f5f7fa;
            padding: 3px 10px;
            border-radius: 15px;
            font-size: 12px;
        }
        
        .modal-backdrop {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.5);
            display: none;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }
        
        .modal {
            background-color: white;
            border-radius: 8px;
            width: 500px;
            max-width: 90%;
            box-shadow: 0 5px 20px rgba(0, 0, 0, 0.2);
        }
        
        .modal-header {
            padding: 15px 20px;
            border-bottom: 1px solid #eee;
            display: flex;
            justify-content: space-between;
            align-items: center;
        }
        
        .modal-title {
            font-size: 18px;
            font-weight: 600;
        }
        
        .modal-close {
            cursor: pointer;
            font-size: 22px;
            color: var(--gray);
        }
        
        .modal-body {
            padding: 20px;
        }
        
        .modal-footer {
            padding: 15px 20px;
            border-top: 1px solid #eee;
            display: flex;
            justify-content: flex-end;
            gap: 10px;
        }
        
        .form-group {
            margin-bottom: 20px;
        }
        
        .form-label {
            display: block;
            margin-bottom: 8px;
            font-weight: 600;
            font-size: 14px;
        }
        
        .form-control {
            width: 100%;
            padding: 10px;
            border: 1px solid #ddd;
            border-radius: 4px;
            font-size: 14px;
        }
        
        .form-control:focus {
            outline: none;
            border-color: var(--primary);
        }
        
        select.form-control {
            appearance: none;
            background-image: url("data:image/svg+xml;charset=utf-8,%3Csvg xmlns='http://www.w3.org/2000/svg' width='16' height='16' viewBox='0 0 24 24' fill='none' stroke='%2395a5a6' stroke-width='2' stroke-linecap='round' stroke-linejoin='round'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
            background-repeat: no-repeat;
            background-position: right 10px center;
            padding-right: 30px;
        }
        
        .logs-container {
            background-color: #2c3e50;
            color: #ecf0f1;
            padding: 15px;
            border-radius: 4px;
            font-family: monospace;
            height: 300px;
            overflow-y: auto;
            margin-top: 20px;
        }
        
        .log-line {
            margin-bottom: 5px;
            line-height: 1.5;
        }
        
        .log-time {
            color: #95a5a6;
            margin-right: 10px;
        }
        
        .log-info {
            color: #3498db;
        }
        
        .log-success {
            color: #2ecc71;
        }
        
        .log-warning {
            color: #f39c12;
        }
        
        .log-error {
            color: #e74c3c;
        }
        
        .pipeline-container {
            display: block;
        }
        
        .pipeline-container.hidden {
            display: none;
        }
        
        @media (max-width: 768px) {
            .quick-stats {
                grid-template-columns: 1fr;
            }
            
            .pipeline-item {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .pipeline-status {
                margin-top: 10px;
            }
            
            .action-btns {
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <header>
            <h1 class="page-title">CI/CD Pipeline Dashboard</h1>
            <button class="btn btn-primary" id="newPipelineBtn">
                <span class="btn-icon">+</span> New Pipeline
            </button>
        </header>
        
        <div class="quick-stats">
            <div class="stat-card">
                <div class="stat-title">Active Pipelines</div>
                <div class="stat-value" id="activePipelines">12</div>
                <div class="stat-trend up" id="activePipelinesTrend">+2 since last month</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Success Rate</div>
                <div class="stat-value" id="successRate">86%</div>
                <div class="stat-trend up" id="successRateTrend">+4% since last month</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Avg. Build Time</div>
                <div class="stat-value" id="buildTime">5m 24s</div>
                <div class="stat-trend down" id="buildTimeTrend">-12s since last month</div>
            </div>
            <div class="stat-card">
                <div class="stat-title">Deployments Today</div>
                <div class="stat-value" id="deploymentsToday">8</div>
                <div class="stat-trend up" id="deploymentsTrend">+2 vs yesterday</div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Pipelines</h2>
                <div class="action-btns">
                    <button class="btn btn-outline btn-sm" id="exportBtn">
                        <span class="btn-icon">↓</span> Export
                    </button>
                    <button class="btn btn-outline btn-sm" id="refreshBtn">
                        <span class="btn-icon">⟳</span> Refresh
                    </button>
                </div>
            </div>
            <div class="card-body">
                <div class="tabs">
                    <div class="tab active" data-tab="all">All Pipelines</div>
                    <div class="tab" data-tab="production">Production</div>
                    <div class="tab" data-tab="staging">Staging</div>
                    <div class="tab" data-tab="development">Development</div>
                </div>
                
                <div id="allPipelines" class="pipeline-container">
                    <ul class="pipeline-list" id="pipelineList">
                        <!-- Pipelines will be populated by JavaScript -->
                    </ul>
                </div>
                
                <div id="productionPipelines" class="pipeline-container hidden">
                    <ul class="pipeline-list" id="productionPipelineList">
                        <!-- Production Pipelines will be populated by JavaScript -->
                    </ul>
                </div>
                
                <div id="stagingPipelines" class="pipeline-container hidden">
                    <ul class="pipeline-list" id="stagingPipelineList">
                        <!-- Staging Pipelines will be populated by JavaScript -->
                    </ul>
                </div>
                
                <div id="developmentPipelines" class="pipeline-container hidden">
                    <ul class="pipeline-list" id="developmentPipelineList">
                        <!-- Development Pipelines will be populated by JavaScript -->
                    </ul>
                </div>
            </div>
        </div>
        
        <div class="card">
            <div class="card-header">
                <h2 class="card-title">Recent Builds</h2>
            </div>
            <div class="card-body">
                <div class="build-history" id="buildHistory">
                    <!-- Recent builds will be populated by JavaScript -->
                </div>
            </div>
        </div>
    </div>
    
    <!-- New Pipeline Modal -->
    <div class="modal-backdrop" id="newPipelineModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Create New Pipeline</h3>
                <span class="modal-close" onclick="closeModal('newPipelineModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Pipeline Name</label>
                    <input type="text" class="form-control" id="pipelineName" placeholder="e.g. Frontend Service">
                </div>
                <div class="form-group">
                    <label class="form-label">Repository URL</label>
                    <input type="text" class="form-control" id="repoUrl" placeholder="e.g. https://github.com/company/repo">
                </div>
                <div class="form-group">
                    <label class="form-label">Branch</label>
                    <input type="text" class="form-control" id="branchName" placeholder="e.g. main">
                </div>
                <div class="form-group">
                    <label class="form-label">Environment</label>
                    <select class="form-control" id="environment">
                        <option value="production">Production</option>
                        <option value="staging">Staging</option>
                        <option value="development">Development</option>
                        <option value="testing">Testing</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Build Configuration</label>
                    <select class="form-control" id="buildConfig">
                        <option>Default Node.js</option>
                        <option>Default Python</option>
                        <option>Default Java</option>
                        <option>Custom</option>
                    </select>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('newPipelineModal')">Cancel</button>
                <button class="btn btn-primary" id="createPipelineBtn">Create Pipeline</button>
            </div>
        </div>
    </div>
    
    <!-- Deployment Modal -->
    <div class="modal-backdrop" id="deployModal">
        <div class="modal">
            <div class="modal-header">
                <h3 class="modal-title">Deploy <span id="deployModalServiceName"></span></h3>
                <span class="modal-close" onclick="closeModal('deployModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="form-group">
                    <label class="form-label">Target Environment</label>
                    <select class="form-control" id="deployEnvironment">
                        <option>Production</option>
                        <option>Staging</option>
                        <option>Development</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Version</label>
                    <select class="form-control" id="deployVersion">
                        <option>Latest (v2.4.1)</option>
                        <option>v2.4.0</option>
                        <option>v2.3.9</option>
                        <option>v2.3.8</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Deployment Strategy</label>
                    <select class="form-control" id="deployStrategy">
                        <option>Rolling Update</option>
                        <option>Blue/Green</option>
                        <option>Canary</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="form-label">Notes</label>
                    <textarea class="form-control" rows="3" placeholder="Optional deployment notes" id="deployNotes"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('deployModal')">Cancel</button>
                <button class="btn btn-success" id="deployBtn">Deploy</button>
            </div>
        </div>
    </div>
    
    <!-- Logs Modal -->
    <div class="modal-backdrop" id="logsModal">
        <div class="modal" style="width: 800px; max-width: 90%;">
            <div class="modal-header">
                <h3 class="modal-title"><span id="logsModalServiceName"></span> Logs</h3>
                <span class="modal-close" onclick="closeModal('logsModal')">&times;</span>
            </div>
            <div class="modal-body">
                <div class="tabs">
                    <div class="tab active" data-log-tab="build">Build Logs</div>
                    <div class="tab" data-log-tab="deployment">Deployment Logs</div>
                    <div class="tab" data-log-tab="runtime">Runtime Logs</div>
                </div>
                
                <div id="buildLogs" class="logs-container">
                    <!-- Build logs will be populated by JavaScript -->
                </div>
                
                <div id="deploymentLogs" class="logs-container" style="display: none;">
                    <!-- Deployment logs will be populated by JavaScript -->
                </div>
                
                <div id="runtimeLogs" class="logs-container" style="display: none;">
                    <!-- Runtime logs will be populated by JavaScript -->
                </div>
            </div>
            <div class="modal-footer">
                <button class="btn btn-outline" onclick="closeModal('logsModal')">Close</button>
                <button class="btn btn-outline" id="downloadLogsBtn">
                    <span class="btn-icon">↓</span> Download Logs
                </button>
            </div>
        </div>
    </div>
    
    <script>
        // Create new pipeline
function createNewPipeline() {
    const name = document.getElementById('pipelineName').value;
    const repo = document.getElementById('repoUrl').value;
    const environment = document.getElementById('environment').value;

    if (!name || !repo) {
        alert('Pipeline name and repository URL are required!');
        return;
    }

    const newPipeline = {
        id: nextPipelineId++,
        name: name,
        repo: repo,
        status: 'pending',
        environment: environment
    };

    pipelines.unshift(newPipeline);

    // Update cost data in local storage
    updateCostData(newPipeline);

    // Refresh UI
    refreshPipelineDisplay();
    closeModal('newPipelineModal');
}

// Function to update cost data
function updateCostData(pipeline) {
    let totalCost = parseFloat(localStorage.getItem('totalCost')) || 0;
    const costPerPipeline = 100; // Example cost per pipeline
    totalCost += costPerPipeline;

    localStorage.setItem('totalCost', totalCost);
    localStorage.setItem('pipelineCount', pipelines.length);
}
        // Initial data
        const initialPipelines = [
            { id: 1, name: "Main API Service", repo: "company/api-service", status: "success", environment: "production" },
            { id: 2, name: "Web Frontend", repo: "company/web-client", status: "running", environment: "staging" },
            { id: 3, name: "Payment Processor", repo: "company/payment-service", status: "failed", environment: "production" },
            { id: 4, name: "Analytics Dashboard", repo: "company/analytics", status: "pending", environment: "development" }
        ];
        
        let pipelines = [...initialPipelines];
        let nextPipelineId = 5;
        
        const initialBuilds = [
            { id: 1, name: "Web Frontend", number: 325, branch: "main branch", triggeredBy: "User Doe", time: "10 min ago", status: "running", duration: "3m 42s" },
            { id: 2, name: "Main API Service", number: 184, branch: "main branch", triggeredBy: "CI", time: "25 min ago", status: "success", duration: "4m 12s" },
            { id: 3, name: "Payment Processor", number: 79, branch: "feature/stripe-integration branch", triggeredBy: "Jane Smith", time: "1h ago", status: "failed", duration: "2m 55s" },
            { id: 4, name: "Analytics Dashboard", number: 42, branch: "develop branch", triggeredBy: "CI", time: "2h ago", status: "success", duration: "6m 18s" }
        ];
        
        let builds = [...initialBuilds];
        let nextBuildId = 5;
        
        // Log data
        const buildLogData = [
            { time: "10:24:15", message: "Starting build process for version 2.4.1...", type: "info" },
            { time: "10:24:16", message: "Installing dependencies..." },
            { time: "10:25:02", message: "Dependencies installed successfully." },
            { time: "10:25:03", message: "Running unit tests..." },
            { time: "10:25:45", message: "All tests passed (124 tests)", type: "success" },
            { time: "10:25:46", message: "Building production assets..." },
            { time: "10:26:30", message: "Production build completed." },
            { time: "10:26:31", message: "Running security scan..." },
            { time: "10:27:05", message: "Security scan complete with warnings.", type: "warning" },
            { time: "10:27:06", message: "- 2 dependencies have minor vulnerabilities", type: "warning" },
            { time: "10:27:07", message: "Running performance tests..." },
            { time: "10:28:22", message: "Performance tests passed.", type: "success" },
            { time: "10:28:23", message: "Preparing deployment package..." },
            { time: "10:28:45", message: "Deployment package created." },
            { time: "10:28:46", message: "Build successful.", type: "success" }
        ];
        
        const deploymentLogData = [
            { time: "11:30:15", message: "Starting deployment to production...", type: "info" },
            { time: "11:30:18", message: "Validating deployment package..." },
            { time: "11:30:25", message: "Backing up existing deployment..." },
            { time: "11:31:10", message: "Backup created successfully." },
            { time: "11:31:12", message: "Deploying new version..." },
            { time: "11:32:45", message: "New version deployed.", type: "success" },
            { time: "11:32:48", message: "Running smoke tests..." },
            { time: "11:33:20", message: "Smoke tests passed.", type: "success" },
            { time: "11:33:22", message: "Updating load balancer configuration..." },
            { time: "11:33:40", message: "Load balancer updated." },
            { time: "11:33:45", message: "Deployment completed successfully!", type: "success" }
        ];
        
        const runtimeLogData = [
            { time: "12:15:03", message: "Application started", type: "info" },
            { time: "12:15:10", message: "Connected to database" },
            { time: "12:16:22", message: "User authentication service initialized" },
            { time: "12:17:05", message: "API cache warmed up", type: "info" },
            { time: "12:18:30", message: "Received high traffic spike", type: "warning" },
            { time: "12:18:45", message: "Auto-scaling triggered" },
            { time: "12:19:30", message: "New instance launched" },
            { time: "12:20:15", message: "Traffic distributed across instances", type: "success" },
            { time: "12:25:00", message: "Memory usage at 65%" },
            { time: "12:30:10", message: "Scheduled maintenance task running" },
            { time: "12:32:00", message: "Maintenance completed successfully", type: "success" }
        ];
        
        // DOM Elements
        const pipelineListEl = document.getElementById('pipelineList');
        const productionPipelineListEl = document.getElementById('productionPipelineList');
        const stagingPipelineListEl = document.getElementById('stagingPipelineList');
        const developmentPipelineListEl = document.getElementById('developmentPipelineList');
        const buildHistoryEl = document.getElementById('buildHistory');
        const tabButtons = document.querySelectorAll('.tab[data-tab]');
        const logTabButtons = document.querySelectorAll('.tab[data-log-tab]');
        const buildLogsContainer = document.getElementById('buildLogs');
        const deploymentLogsContainer = document.getElementById('deploymentLogs');
        const runtimeLogsContainer = document.getElementById('runtimeLogs');
        
        // Add event listeners
        document.getElementById('newPipelineBtn').addEventListener('click', function() {
            document.getElementById('newPipelineModal').style.display = 'flex';
        });
        
        document.getElementById('createPipelineBtn').addEventListener('click', createNewPipeline);
        
        document.getElementById('downloadLogsBtn').addEventListener('click', function() {
            downloadLogs();
        });
        
        document.getElementById('deployBtn').addEventListener('click', function() {
            deployService();
        });
        
        document.getElementById('refreshBtn').addEventListener('click', function() {
            refreshPipelines();
        });
        
        document.getElementById('exportBtn').addEventListener('click', function() {
            exportPipelines();
        });
        
        // Tab switching
        tabButtons.forEach(tab => {
            tab.addEventListener('click', function() {
                // Deactivate all tabs
                tabButtons.forEach(t => t.classList.remove('active'));
                
                // Hide all pipeline containers
                document.getElementById('allPipelines').classList.add('hidden');
                document.getElementById('productionPipelines').classList.add('hidden');
                document.getElementById('stagingPipelines').classList.add('hidden');
                document.getElementById('developmentPipelines').classList.add('hidden');
                
                // Activate selected tab
                this.classList.add('active');
                
                // Show selected pipeline container
                const tabId = this.getAttribute('data-tab');
                document.getElementById(tabId + 'Pipelines').classList.remove('hidden');
            });
        });
        
        // Log tab switching
        logTabButtons.forEach(tab => {
            tab.addEventListener('click', function() {
                // Deactivate all tabs
                logTabButtons.forEach(t => t.classList.remove('active'));
                
                // Hide all log containers
                buildLogsContainer.style.display = 'none';
                deploymentLogsContainer.style.display = 'none';
                runtimeLogsContainer.style.display = 'none';
                
                // Activate selected tab
                this.classList.add('active');
                
                // Show selected log container
                const tabId = this.getAttribute('data-log-tab');
                document.getElementById(tabId + 'Logs').style.display = 'block';
            });
        });
        
        // Close modal functions
        function closeModal(modalId) {
            document.getElementById(modalId).style.display = 'none';
        }
        
        // Show deploy modal
        function showDeployModal(serviceName) {
            document.getElementById('deployModalServiceName').textContent = serviceName;
            document.getElementById('deployModal').style.display = 'flex';
        }
        
        // Show logs modal
        function showLogsModal(serviceName) {
            document.getElementById('logsModalServiceName').textContent = serviceName;
            document.getElementById('logsModal').style.display = 'flex';
            
            //
        // Reset log containers and populate them with log data
buildLogsContainer.innerHTML = '';
deploymentLogsContainer.innerHTML = '';
runtimeLogsContainer.innerHTML = '';

// Populate build logs
buildLogData.forEach(log => {
    const logElement = createLogElement(log);
    buildLogsContainer.appendChild(logElement);
});

// Populate deployment logs
deploymentLogData.forEach(log => {
    const logElement = createLogElement(log);
    deploymentLogsContainer.appendChild(logElement);
});

// Populate runtime logs
runtimeLogData.forEach(log => {
    const logElement = createLogElement(log);
    runtimeLogsContainer.appendChild(logElement);
});

// Make sure the build logs are shown by default
buildLogsContainer.style.display = 'block';
}

// Create a log element from log data
function createLogElement(log) {
    const logElement = document.createElement('div');
    logElement.className = 'log-line';
    
    const timeSpan = document.createElement('span');
    timeSpan.className = 'log-time';
    timeSpan.textContent = log.time;
    
    const messageSpan = document.createElement('span');
    
    // Add specific class based on log type
    if (log.type) {
        messageSpan.className = `log-${log.type}`;
    }
    
    messageSpan.textContent = log.message;
    
    logElement.appendChild(timeSpan);
    logElement.appendChild(messageSpan);
    
    return logElement;
}

// Create new pipeline
function createNewPipeline() {
    const name = document.getElementById('pipelineName').value;
    const repo = document.getElementById('repoUrl').value;
    const environment = document.getElementById('environment').value;
    
    if (!name || !repo) {
        alert('Pipeline name and repository URL are required!');
        return;
    }
    
    const newPipeline = {
        id: nextPipelineId++,
        name: name,
        repo: repo,
        status: 'pending',
        environment: environment
    };
    
    pipelines.unshift(newPipeline);
    
    // Add new build for this pipeline
    const newBuild = {
        id: nextBuildId++,
        name: name,
        number: 1,
        branch: document.getElementById('branchName').value || 'main',
        triggeredBy: 'You',
        time: 'Just now',
        status: 'pending',
        duration: '0m 0s'
    };
    
    builds.unshift(newBuild);
    
    refreshPipelineDisplay();
    refreshBuildHistory();
    closeModal('newPipelineModal');
    
    // Reset form fields
    document.getElementById('pipelineName').value = '';
    document.getElementById('repoUrl').value = '';
    document.getElementById('branchName').value = '';
    
    // Update stats
    updateStats();
    
    // Simulate pipeline starting
    setTimeout(() => {
        newPipeline.status = 'running';
        newBuild.status = 'running';
        refreshPipelineDisplay();
        refreshBuildHistory();
        
        // Simulate pipeline completion after random time
        const completionTime = Math.floor(Math.random() * 5000) + 3000;
        setTimeout(() => {
            const success = Math.random() > 0.2; // 80% chance of success
            newPipeline.status = success ? 'success' : 'failed';
            newBuild.status = success ? 'success' : 'failed';
            newBuild.duration = `${Math.floor(completionTime / 1000)}m ${Math.floor(Math.random() * 60)}s`;
            refreshPipelineDisplay();
            refreshBuildHistory();
            updateStats();
        }, completionTime);
    }, 1500);
}

// Refresh pipelines
function refreshPipelines() {
    // Simulate loading with animation
    const statCards = document.querySelectorAll('.stat-card');
    statCards.forEach(card => card.classList.add('updating'));
    
    setTimeout(() => {
        // Randomly change some pipeline statuses
        pipelines.forEach(pipeline => {
            if (Math.random() < 0.3) { // 30% chance to change status
                const statuses = ['success', 'running', 'failed', 'pending'];
                const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];
                pipeline.status = randomStatus;
            }
        });
        
        refreshPipelineDisplay();
        updateStats();
        
        // Remove updating animation
        statCards.forEach(card => card.classList.remove('updating'));
    }, 1000);
}

// Deploy service
function deployService() {
    const serviceName = document.getElementById('deployModalServiceName').textContent;
    const environment = document.getElementById('deployEnvironment').value;
    const version = document.getElementById('deployVersion').value;
    
    // Add build history entry for deployment
    const newBuild = {
        id: nextBuildId++,
        name: serviceName,
        number: Math.floor(Math.random() * 100) + 400,
        branch: 'main',
        triggeredBy: 'You (Deployment)',
        time: 'Just now',
        status: 'running',
        duration: '0m 0s'
    };
    
    builds.unshift(newBuild);
    refreshBuildHistory();
    
    closeModal('deployModal');
    
    // Simulate deployment completion
    setTimeout(() => {
        newBuild.status = 'success';
        newBuild.duration = `${Math.floor(Math.random() * 5) + 1}m ${Math.floor(Math.random() * 60)}s`;
        refreshBuildHistory();
        updateStats();
        
        // Show success message
        alert(`Successfully deployed ${serviceName} to ${environment} environment.`);
    }, 3000);
}

// Export pipelines
function exportPipelines() {
    const exportData = JSON.stringify(pipelines, null, 2);
    const blob = new Blob([exportData], { type: 'application/json' });
    const url = URL.createObjectURL(blob);
    
    const a = document.createElement('a');
    a.href = url;
    a.download = 'pipelines-export.json';
    a.click();
    
    URL.revokeObjectURL(url);
}

// Download logs
function downloadLogs() {
    let logsContent = '';
    const serviceName = document.getElementById('logsModalServiceName').textContent;
    
    // Determine which logs are visible
    let activeLogTab = 'build';
    logTabButtons.forEach(tab => {
        if (tab.classList.contains('active')) {
            activeLogTab = tab.getAttribute('data-log-tab');
        }
    });
    
    // Get appropriate log data
    let logData;
    switch (activeLogTab) {
        case 'build':
            logData = buildLogData;
            break;
        case 'deployment':
            logData = deploymentLogData;
            break;
        case 'runtime':
            logData = runtimeLogData;
            break;
    }
    
    // Create log content
    logsContent = `===== ${serviceName} ${activeLogTab.toUpperCase()} LOGS =====\n\n`;
    logData.forEach(log => {
        logsContent += `[${log.time}] ${log.message}\n`;
    });
    
    // Create download
    const blob = new Blob([logsContent], { type: 'text/plain' });
    const url = URL.createObjectURL(blob);
    
    const a = document.createElement('a');
    a.href = url;
    a.download = `${serviceName.toLowerCase().replace(/\s+/g, '-')}-${activeLogTab}-logs.txt`;
    a.click();
    
    URL.revokeObjectURL(url);
}

// Update dashboard stats
function updateStats() {
    // Count active pipelines
    document.getElementById('activePipelines').textContent = pipelines.length;
    
    // Calculate success rate
    const successfulPipelines = pipelines.filter(p => p.status === 'success').length;
    const successRate = Math.round((successfulPipelines / pipelines.length) * 100);
    document.getElementById('successRate').textContent = `${successRate}%`;
    
    // Calculate build time (random for demo)
    const minutes = Math.floor(Math.random() * 7) + 3;
    const seconds = Math.floor(Math.random() * 60);
    document.getElementById('buildTime').textContent = `${minutes}m ${seconds}s`;
    
    // Set deployments today (random for demo)
    const deployments = Math.floor(Math.random() * 5) + 5;
    document.getElementById('deploymentsToday').textContent = deployments;
    
    // Update trends
    const trends = ['+2', '+1', '0', '-1', '+3'];
    const randomTrend = trends[Math.floor(Math.random() * trends.length)];
    document.getElementById('deploymentsTrend').textContent = `${randomTrend} vs yesterday`;
    
    // Update trend classes
    const activePipelinesTrend = document.getElementById('activePipelinesTrend');
    const successRateTrend = document.getElementById('successRateTrend');
    const buildTimeTrend = document.getElementById('buildTimeTrend');
    const deploymentsTrend = document.getElementById('deploymentsTrend');
    
    // Toggle up/down class based on first character of trend text
    activePipelinesTrend.className = activePipelinesTrend.textContent.startsWith('+') ? 'stat-trend up' : 'stat-trend down';
    successRateTrend.className = successRateTrend.textContent.startsWith('+') ? 'stat-trend up' : 'stat-trend down';
    buildTimeTrend.className = buildTimeTrend.textContent.startsWith('-') ? 'stat-trend down' : 'stat-trend up';
    deploymentsTrend.className = deploymentsTrend.textContent.startsWith('+') ? 'stat-trend up' : 'stat-trend down';
}

// Refresh pipeline display
function refreshPipelineDisplay() {
    // Clear lists
    pipelineListEl.innerHTML = '';
    productionPipelineListEl.innerHTML = '';
    stagingPipelineListEl.innerHTML = '';
    developmentPipelineListEl.innerHTML = '';
    
    // Add pipelines to appropriate lists
    pipelines.forEach(pipeline => {
        const pipelineElement = createPipelineElement(pipeline);
        
        // Add to all pipelines list
        pipelineListEl.appendChild(pipelineElement.cloneNode(true));
        
        // Add to environment-specific list
        switch (pipeline.environment) {
            case 'production':
                productionPipelineListEl.appendChild(pipelineElement.cloneNode(true));
                break;
            case 'staging':
                stagingPipelineListEl.appendChild(pipelineElement.cloneNode(true));
                break;
            case 'development':
                developmentPipelineListEl.appendChild(pipelineElement.cloneNode(true));
                break;
        }
    });
    
    // Add event listeners to new elements
    attachPipelineEventListeners();
}

// Create pipeline element
function createPipelineElement(pipeline) {
    const li = document.createElement('li');
    li.className = 'pipeline-item';
    li.dataset.id = pipeline.id;
    
    const infoDiv = document.createElement('div');
    infoDiv.className = 'pipeline-info';
    
    const nameSpan = document.createElement('span');
    nameSpan.className = 'pipeline-name';
    nameSpan.textContent = pipeline.name;
    
    const repoSpan = document.createElement('span');
    repoSpan.className = 'pipeline-repo';
    repoSpan.textContent = pipeline.repo;
    
    infoDiv.appendChild(nameSpan);
    infoDiv.appendChild(repoSpan);
    
    const statusDiv = document.createElement('div');
    statusDiv.className = 'pipeline-status';
    
    const statusBadge = document.createElement('span');
    statusBadge.className = `status-badge status-${pipeline.status}`;
    statusBadge.textContent = capitalizeFirstLetter(pipeline.status);
    
    const actionBtns = document.createElement('div');
    actionBtns.className = 'action-btns';
    
    const logsBtn = document.createElement('button');
    logsBtn.className = 'btn btn-outline btn-sm logs-btn';
    logsBtn.textContent = 'Logs';
    logsBtn.dataset.name = pipeline.name;
    
    const deployBtn = document.createElement('button');
    deployBtn.className = 'btn btn-primary btn-sm deploy-btn';
    deployBtn.textContent = 'Deploy';
    deployBtn.dataset.name = pipeline.name;
    
    actionBtns.appendChild(logsBtn);
    actionBtns.appendChild(deployBtn);
    
    statusDiv.appendChild(statusBadge);
    statusDiv.appendChild(actionBtns);
    
    li.appendChild(infoDiv);
    li.appendChild(statusDiv);
    
    return li;
}

// Refresh build history
function refreshBuildHistory() {
    buildHistoryEl.innerHTML = '';
    
    builds.slice(0, 5).forEach(build => {
        const historyItem = document.createElement('div');
        historyItem.className = 'history-item';
        
        const historyDetails = document.createElement('div');
        historyDetails.className = 'history-details';
        
        const buildNumber = document.createElement('div');
        buildNumber.className = 'build-number';
        buildNumber.textContent = `${build.name} #${build.number}`;
        
        const buildInfo = document.createElement('div');
        buildInfo.className = 'build-info';
        
        const branchSpan = document.createElement('span');
        branchSpan.textContent = build.branch;
        
        const triggeredBySpan = document.createElement('span');
        triggeredBySpan.textContent = `by ${build.triggeredBy}`;
        
        const timeSpan = document.createElement('span');
        timeSpan.textContent = build.time;
        
        buildInfo.appendChild(branchSpan);
        buildInfo.appendChild(triggeredBySpan);
        buildInfo.appendChild(timeSpan);
        
        historyDetails.appendChild(buildNumber);
        historyDetails.appendChild(buildInfo);
        
        const buildStatus = document.createElement('div');
        buildStatus.className = 'pipeline-status';
        
        const statusBadge = document.createElement('span');
        statusBadge.className = `status-badge status-${build.status}`;
        statusBadge.textContent = capitalizeFirstLetter(build.status);
        
        const durationBadge = document.createElement('span');
        durationBadge.className = 'build-duration';
        durationBadge.textContent = build.duration;
        
        buildStatus.appendChild(statusBadge);
        buildStatus.appendChild(durationBadge);
        
        historyItem.appendChild(historyDetails);
        historyItem.appendChild(buildStatus);
        
        buildHistoryEl.appendChild(historyItem);
    });
}

// Attach event listeners to pipeline elements
function attachPipelineEventListeners() {
    // Log buttons
    document.querySelectorAll('.logs-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            showLogsModal(this.dataset.name);
        });
    });
    
    // Deploy buttons
    document.querySelectorAll('.deploy-btn').forEach(btn => {
        btn.addEventListener('click', function() {
            showDeployModal(this.dataset.name);
        });
    });
}

// Helper function to capitalize first letter
function capitalizeFirstLetter(string) {
    return string.charAt(0).toUpperCase() + string.slice(1);
}

// Initialize dashboard
function initDashboard() {
    refreshPipelineDisplay();
    refreshBuildHistory();
    updateStats();
    
    // Populate log containers
    buildLogData.forEach(log => {
        const logElement = createLogElement(log);
        buildLogsContainer.appendChild(logElement);
    });
}

// Start the dashboard
document.addEventListener('DOMContentLoaded', initDashboard);
// Simulate real-time updates
setInterval(() => {
    // Randomly update a pipeline status
    if (pipelines.length > 0 && Math.random() < 0.3) {
        const randomIndex = Math.floor(Math.random() * pipelines.length);
        const statuses = ['success', 'running', 'failed', 'pending'];
        const randomStatus = statuses[Math.floor(Math.random() * statuses.length)];
        
        pipelines[randomIndex].status = randomStatus;
        refreshPipelineDisplay();
    }
    
    // Add a new build occasionally
    if (Math.random() < 0.1) {
        const randomPipeline = pipelines[Math.floor(Math.random() * pipelines.length)];
        const newBuild = {
            id: nextBuildId++,
            name: randomPipeline.name,
            number: Math.floor(Math.random() * 100) + 200,
            branch: Math.random() < 0.8 ? 'main branch' : 'feature/new-feature branch',
            triggeredBy: Math.random() < 0.5 ? 'CI' : 'Automated Test',
            time: 'Just now',
            status: 'running',
            duration: '0m 0s'
        };
        
        builds.unshift(newBuild);
        if (builds.length > 20) {
            builds.pop();
        }
        
        refreshBuildHistory();
        
        // Simulate build completion
        setTimeout(() => {
            const success = Math.random() > 0.2;
            newBuild.status = success ? 'success' : 'failed';
            newBuild.duration = `${Math.floor(Math.random() * 5) + 1}m ${Math.floor(Math.random() * 60)}s`;
            newBuild.time = 'A few seconds ago';
            refreshBuildHistory();
            updateStats();
        }, Math.random() * 3000 + 2000);
    }
    
    // Update stats occasionally
    if (Math.random() < 0.2) {
        updateStats();
    }
}, 5000);
</script>
</body>
</html>